package com.example.ndk;

import java.util.ArrayList;
import java.util.List;

import android.app.Activity;
import android.content.pm.ApplicationInfo;
import android.content.pm.PackageManager;
import android.os.Bundle;
import android.widget.ArrayAdapter;
import android.widget.ListView;

public class checkthestartslef extends Activity {
	ListView listView;

	@Override
	protected void onCreate(Bundle savedInstanceState) {
		// TODO Auto-generated method stub
		super.onCreate(savedInstanceState);
		setContentView(R.layout.listview_main);
		listView = (ListView) findViewById(R.id.list);
		// 添加适配器Adapter
		listView.setAdapter(new ArrayAdapter<String>(this,
				android.R.layout.simple_list_item_1, getAppInfo()));
	}

	// 拿到开机启动app的信息
	private String[] getAppInfo() {
		// 拿到已安装程序的信息
		List<ApplicationInfo> allAppList = getPackageManager()
				.getInstalledApplications(0);
		// 新建一个ArrayList数组
		List<String> autoBootAppList = new ArrayList<String>();
		for (ApplicationInfo appinfo : allAppList) {
			if (PackageManager.PERMISSION_GRANTED == getPackageManager()
					.checkPermission(WIFI_SERVICE, appinfo.packageName)) {
				if ((appinfo.flags & ApplicationInfo.FLAG_SYSTEM) <= 0) {
					autoBootAppList.add(appinfo.packageName);
				}
			}
		}
		return autoBootAppList.toArray(new String[autoBootAppList.size()]);
	}
}
